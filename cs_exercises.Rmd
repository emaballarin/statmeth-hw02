---
title: "SMDS Homework - Block 2"
output:
  html_document:
    df_print: paged
---

## *__CS__ EXERCISES*

__Exercise 3.3 - Cap 3__

Rewrite the following, replacing the loop with efficient code:

```{r}
n <- 100000; z <- rnorm(n)
zneg <- 0;j <- 1
for (i in 1:n) {
  if (z[i]<0) {
    zneg[j] <- z[i]
    j <- j + 1
  }
}
```

Confirm that your rewrite is faster but gives the same result.

*__Solution__*

```{r}
library(stats)

naive_method <- function(n, z){
  zneg_1 <- 0; j_1 <- 1
  for (i in 1:n) {
    if (z[i]<0) {
      zneg_1[j_1] <- z[i]
      j_1 <- j_1 + 1
    }
  }
  return(zneg_1)
}

eff_method <- function(z){
  zneg_2 <- ifelse(z<0, z, NA)
  zneg_2 <- zneg_2[!is.na(zneg_2)]
  j_2 <- length(zneg_2) + 1
  return(zneg_2)
}

n <- 100000; z <- rnorm(n)
naive_time <- system.time(zneg_1 <- naive_method(n, z))
eff_time <- system.time(zneg_2 <- eff_method(z))

comparison <- zneg_1 == zneg_2
paste("elements that are diffent:", which(comparison == FALSE))

print("naive time:"); naive_time
print("eff time:"); eff_time
```

__Exercise 3.5 - Cap 3__

Consider solving the matrix equation $Ax = y$ for $x$ , where $y$ is a known $n$
vector and $A$ is a known $n × n$ matrix. The formal solution to the problem is
$x = A^{-1} \cdot y$ , but it is possible to solve the equation directly, without actually
forming $A^{−1}$ . This question explores this direct solution. Read the help file
for solve before trying it.

a) First create an $A$ , $x$ and $y$ satisfying $Ax = y$.
```{r}
set.seed(0); n <- 1000
A <- matrix(runif(n*n),n,n); x.true <- runif(n)
y <- A%*%x.true
```
The idea is to experiment with solving $Ax = y$ for $x$ , but with a known
truth to compare the answer to.

b) Using solve , form the matrix $A^{-1}$ explicitly and then form $x_{1} =
A^{-1} \cdot y$ . Note how long this takes. Also assess the mean absolute differ-
ence between $x_1$ and $x.true$ (the approximate mean absolute ‘error’ in
the solution).

c) Now use solve to directly solve for $x$ without forming $A^{−1}$ . Note how
long this takes and assess the mean absolute error of the result.

d) What do you conclude?

*__Solution__*

__a)__

```{r}
set.seed(0); n <- 1000
A <- matrix(runif(n*n),n,n); x.true <- runif(n)
y <- A%*%x.true
```

__b)__

```{r}
form_inverse <- system.time(AI <- solve(A))
x_1 <- AI %*% y

mean(abs(x_1 - x.true))
```

__c)__

```{r}
dir_inverse <- system.time(x_2 <- solve(A, y))
mean(abs(x_2 - x.true))
```

__d)__

```{r}
print("system time to solve Ax = y by performing the A inverse:")
form_inverse

print("system time to solve Ax = y by using directly solve function:")
dir_inverse
```

From the experiment results the best choice is to use $solve$ function to directly solve for $x$ without forming $A^{-1}$; indeed, both mean absolute difference and system time are much less then the other option
